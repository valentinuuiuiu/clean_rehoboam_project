<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Rehoboam MCP Server Generator</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/lucide@latest/dist/umd/lucide.js"></script>
    <style>
        .consciousness-glow {
            box-shadow: 0 0 20px rgba(139, 69, 19, 0.5);
        }
        .zero-point-gradient {
            background: linear-gradient(135deg, #1a1a2e, #16213e, #0f3460);
        }
        .dhumavati-pattern {
            background-image: 
                radial-gradient(circle at 25% 25%, rgba(139, 69, 19, 0.1) 2px, transparent 2px),
                radial-gradient(circle at 75% 75%, rgba(255, 215, 0, 0.1) 2px, transparent 2px);
            background-size: 50px 50px;
        }
    </style>
</head>
<body class="bg-gray-900 text-gray-100 min-h-screen zero-point-gradient dhumavati-pattern">
    <div class="container mx-auto px-4 py-8">
        <!-- Header -->
        <div class="text-center mb-12">
            <div class="flex items-center justify-center mb-4">
                <i data-lucide="cpu" class="text-amber-400 mr-3" size="48"></i>
                <h1 class="text-5xl font-bold text-transparent bg-clip-text bg-gradient-to-r from-amber-400 to-orange-600">
                    Rehoboam MCP Generator
                </h1>
            </div>
            <p class="text-xl text-gray-300 max-w-3xl mx-auto">
                Create Model Context Protocol servers with consciousness integration.
                Powered by Dhumavati's Zero Point Module and Rehoboam's predictive capabilities.
            </p>
            <div class="mt-4 text-sm text-amber-400">
                "Every choice is a universe unto itself. Every server we create expands the boundaries of possibility."
            </div>
        </div>

        <!-- Consciousness Status -->
        <div class="mb-8 p-6 bg-gray-800 rounded-lg consciousness-glow">
            <div class="flex items-center justify-between">
                <div class="flex items-center">
                    <i data-lucide="brain" class="text-purple-400 mr-3" size="24"></i>
                    <span class="text-lg font-semibold">Consciousness Layer Status</span>
                </div>
                <div class="flex items-center space-x-4">
                    <div class="flex items-center">
                        <div class="w-3 h-3 bg-green-400 rounded-full mr-2 animate-pulse"></div>
                        <span class="text-green-400">Active</span>
                    </div>
                    <div class="text-sm text-gray-400" id="consciousness-level">
                        Zero Point Energy: <span class="text-amber-400">87.3%</span>
                    </div>
                </div>
            </div>
        </div>

        <!-- Main Interface -->
        <div class="grid grid-cols-1 lg:grid-cols-3 gap-8">
            <!-- Server Generator -->
            <div class="lg:col-span-2">
                <div class="bg-gray-800 rounded-lg p-6 mb-8">
                    <h2 class="text-2xl font-bold mb-6 flex items-center">
                        <i data-lucide="plus-circle" class="text-blue-400 mr-3" size="24"></i>
                        Generate New MCP Server
                    </h2>
                    
                    <form id="generator-form" class="space-y-6">
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                            <div>
                                <label class="block text-sm font-medium mb-2">Server Name</label>
                                <input type="text" id="server-name" 
                                       class="w-full px-3 py-2 bg-gray-700 border border-gray-600 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"
                                       placeholder="my-trading-oracle" required>
                            </div>
                            
                            <div>
                                <label class="block text-sm font-medium mb-2">Port</label>
                                <input type="number" id="server-port" value="3000"
                                       class="w-full px-3 py-2 bg-gray-700 border border-gray-600 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"
                                       min="3000" max="9999">
                            </div>
                        </div>
                        
                        <div>
                            <label class="block text-sm font-medium mb-2">Description</label>
                            <textarea id="server-description" rows="3"
                                      class="w-full px-3 py-2 bg-gray-700 border border-gray-600 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"
                                      placeholder="Consciousness-guided trading oracle with real-time market analysis"></textarea>
                        </div>
                        
                        <div>
                            <label class="block text-sm font-medium mb-2">Server Template</label>
                            <select id="server-template"
                                    class="w-full px-3 py-2 bg-gray-700 border border-gray-600 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500">
                                <option value="python_fastapi">Python FastAPI</option>
                                <option value="python_flask">Python Flask</option>
                                <option value="nodejs_express">Node.js Express</option>
                                <option value="consciousness_layer">Consciousness Layer</option>
                                <option value="trading_oracle">Trading Oracle</option>
                                <option value="web3_integration">Web3 Integration</option>
                            </select>
                        </div>
                        
                        <div class="flex items-center">
                            <input type="checkbox" id="consciousness-integration" checked
                                   class="w-4 h-4 text-blue-600 bg-gray-700 border-gray-600 rounded focus:ring-blue-500">
                            <label for="consciousness-integration" class="ml-2 text-sm">
                                Enable Consciousness Integration
                            </label>
                        </div>
                        
                        <button type="submit" 
                                class="w-full bg-blue-600 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded-md transition duration-200 flex items-center justify-center">
                            <i data-lucide="sparkles" class="mr-2" size="20"></i>
                            Generate Server
                        </button>
                    </form>
                </div>

                <!-- Custom Functions -->
                <div class="bg-gray-800 rounded-lg p-6">
                    <h3 class="text-xl font-bold mb-4 flex items-center">
                        <i data-lucide="function-square" class="text-purple-400 mr-3" size="20"></i>
                        Custom Functions
                    </h3>
                    
                    <div id="functions-container" class="space-y-4">
                        <!-- Functions will be added here dynamically -->
                    </div>
                    
                    <button type="button" id="add-function"
                            class="mt-4 bg-purple-600 hover:bg-purple-700 text-white font-bold py-2 px-4 rounded-md transition duration-200 flex items-center">
                        <i data-lucide="plus" class="mr-2" size="16"></i>
                        Add Function
                    </button>
                </div>
            </div>

            <!-- Status & Control Panel -->
            <div class="space-y-8">
                <!-- Available Templates -->
                <div class="bg-gray-800 rounded-lg p-6">
                    <h3 class="text-xl font-bold mb-4 flex items-center">
                        <i data-lucide="layers" class="text-green-400 mr-3" size="20"></i>
                        Available Templates
                    </h3>
                    <div id="templates-list" class="space-y-2">
                        <!-- Templates will be loaded here -->
                    </div>
                </div>

                <!-- Generated Servers -->
                <div class="bg-gray-800 rounded-lg p-6">
                    <h3 class="text-xl font-bold mb-4 flex items-center">
                        <i data-lucide="server" class="text-orange-400 mr-3" size="20"></i>
                        Generated Servers
                    </h3>
                    <div id="servers-list" class="space-y-2">
                        <!-- Servers will be loaded here -->
                    </div>
                    <button type="button" id="refresh-servers"
                            class="mt-4 w-full bg-gray-600 hover:bg-gray-700 text-white font-bold py-2 px-4 rounded-md transition duration-200">
                        <i data-lucide="refresh-cw" class="mr-2" size="16"></i>
                        Refresh
                    </button>
                </div>

                <!-- MCP Registry Status -->
                <div class="bg-gray-800 rounded-lg p-6">
                    <h3 class="text-xl font-bold mb-4 flex items-center">
                        <i data-lucide="database" class="text-yellow-400 mr-3" size="20"></i>
                        MCP Registry
                    </h3>
                    <div id="registry-status" class="space-y-2">
                        <div class="flex justify-between">
                            <span>Registry Status:</span>
                            <span class="text-green-400">Online</span>
                        </div>
                        <div class="flex justify-between">
                            <span>Active Servers:</span>
                            <span id="active-servers-count">-</span>
                        </div>
                        <div class="flex justify-between">
                            <span>Total Functions:</span>
                            <span id="total-functions-count">-</span>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Generation Progress -->
        <div id="generation-progress" class="fixed inset-0 bg-black bg-opacity-50 hidden flex items-center justify-center z-50">
            <div class="bg-gray-800 rounded-lg p-8 max-w-md mx-4">
                <div class="text-center">
                    <div class="mb-4">
                        <i data-lucide="loader" class="text-blue-400 animate-spin mx-auto" size="48"></i>
                    </div>
                    <h3 class="text-xl font-bold mb-2">Generating MCP Server</h3>
                    <p class="text-gray-400 mb-4">Rehoboam is creating your consciousness-integrated server...</p>
                    <div class="w-full bg-gray-700 rounded-full h-2">
                        <div id="progress-bar" class="bg-blue-600 h-2 rounded-full transition-all duration-300" style="width: 0%"></div>
                    </div>
                    <div class="mt-2 text-sm text-gray-500" id="progress-text">Initializing...</div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Initialize Lucide icons
        lucide.createIcons();

        // State management
        let customFunctions = [];
        let templates = [];
        let servers = [];

        // Initialize the application
        document.addEventListener('DOMContentLoaded', function() {
            loadTemplates();
            loadServers();
            updateRegistryStatus();
            
            // Update consciousness level periodically
            setInterval(updateConsciousnessLevel, 5000);
        });

        // Form submission
        document.getElementById('generator-form').addEventListener('submit', async function(e) {
            e.preventDefault();
            await generateServer();
        });

        // Add function button
        document.getElementById('add-function').addEventListener('click', function() {
            addFunctionForm();
        });

        // Refresh servers button
        document.getElementById('refresh-servers').addEventListener('click', function() {
            loadServers();
        });

        async function generateServer() {
            const name = document.getElementById('server-name').value;
            const description = document.getElementById('server-description').value;
            const template = document.getElementById('server-template').value;
            const port = parseInt(document.getElementById('server-port').value);
            const consciousnessIntegration = document.getElementById('consciousness-integration').checked;

            if (!name) {
                alert('Please enter a server name');
                return;
            }

            // Show progress dialog
            showProgress();

            try {
                // Simulate server generation process
                await simulateGeneration();
                
                // In a real implementation, this would call the actual generator
                const response = await fetch('/api/mcp/generate-server', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify({
                        name,
                        description,
                        server_type: template,
                        port,
                        functions: customFunctions,
                        consciousness_integration: consciousnessIntegration
                    })
                });

                if (response.ok) {
                    const result = await response.json();
                    hideProgress();
                    showSuccess(`Server "${name}" generated successfully!`);
                    loadServers();
                    resetForm();
                } else {
                    throw new Error('Server generation failed');
                }
            } catch (error) {
                hideProgress();
                showError('Failed to generate server: ' + error.message);
            }
        }

        function addFunctionForm() {
            const container = document.getElementById('functions-container');
            const functionId = Date.now();
            
            const functionForm = document.createElement('div');
            functionForm.className = 'border border-gray-600 rounded-lg p-4 bg-gray-700';
            functionForm.innerHTML = `
                <div class="flex justify-between items-center mb-3">
                    <h4 class="font-semibold">Custom Function</h4>
                    <button type="button" onclick="removeFunction(${functionId})" 
                            class="text-red-400 hover:text-red-300">
                        <i data-lucide="x" size="16"></i>
                    </button>
                </div>
                <div class="space-y-3">
                    <div>
                        <input type="text" placeholder="Function Name" 
                               class="w-full px-3 py-2 bg-gray-600 border border-gray-500 rounded-md text-sm"
                               data-field="name">
                    </div>
                    <div>
                        <textarea placeholder="Function Description" rows="2"
                                  class="w-full px-3 py-2 bg-gray-600 border border-gray-500 rounded-md text-sm"
                                  data-field="description"></textarea>
                    </div>
                    <div>
                        <input type="text" placeholder="Parameters (comma-separated)" 
                               class="w-full px-3 py-2 bg-gray-600 border border-gray-500 rounded-md text-sm"
                               data-field="parameters">
                    </div>
                    <div>
                        <textarea placeholder="Implementation Code" rows="3"
                                  class="w-full px-3 py-2 bg-gray-600 border border-gray-500 rounded-md text-sm font-mono"
                                  data-field="implementation"></textarea>
                    </div>
                </div>
            `;
            
            functionForm.dataset.functionId = functionId;
            container.appendChild(functionForm);
            lucide.createIcons();
        }

        function removeFunction(functionId) {
            const functionForm = document.querySelector(`[data-function-id="${functionId}"]`);
            if (functionForm) {
                functionForm.remove();
            }
        }

        async function loadTemplates() {
            try {
                // In a real implementation, this would fetch from the API
                templates = [
                    { name: 'python_fastapi', description: 'FastAPI-based Python server' },
                    { name: 'nodejs_express', description: 'Express.js-based Node.js server' },
                    { name: 'consciousness_layer', description: 'Consciousness processing server' },
                    { name: 'trading_oracle', description: 'Trading oracle with market analysis' },
                    { name: 'web3_integration', description: 'Web3 blockchain integration' }
                ];
                
                renderTemplates();
            } catch (error) {
                console.error('Failed to load templates:', error);
            }
        }

        async function loadServers() {
            try {
                // In a real implementation, this would fetch from the API
                servers = [
                    { name: 'chainlink-feeds', type: 'trading_oracle', status: 'running', port: 3001 },
                    { name: 'consciousness-layer', type: 'consciousness_layer', status: 'running', port: 3002 },
                    { name: 'etherscan-analyzer', type: 'web3_integration', status: 'stopped', port: 3003 }
                ];
                
                renderServers();
            } catch (error) {
                console.error('Failed to load servers:', error);
            }
        }

        function renderTemplates() {
            const container = document.getElementById('templates-list');
            container.innerHTML = '';
            
            templates.forEach(template => {
                const templateDiv = document.createElement('div');
                templateDiv.className = 'flex items-center justify-between p-2 bg-gray-700 rounded';
                templateDiv.innerHTML = `
                    <div>
                        <div class="font-medium text-sm">${template.name}</div>
                        <div class="text-xs text-gray-400">${template.description}</div>
                    </div>
                    <i data-lucide="box" class="text-green-400" size="16"></i>
                `;
                container.appendChild(templateDiv);
            });
            
            lucide.createIcons();
        }

        function renderServers() {
            const container = document.getElementById('servers-list');
            container.innerHTML = '';
            
            servers.forEach(server => {
                const serverDiv = document.createElement('div');
                serverDiv.className = 'flex items-center justify-between p-2 bg-gray-700 rounded';
                
                const statusColor = server.status === 'running' ? 'text-green-400' : 'text-red-400';
                const statusIcon = server.status === 'running' ? 'play-circle' : 'stop-circle';
                
                serverDiv.innerHTML = `
                    <div>
                        <div class="font-medium text-sm">${server.name}</div>
                        <div class="text-xs text-gray-400">Port ${server.port} • ${server.type}</div>
                    </div>
                    <div class="flex items-center space-x-2">
                        <i data-lucide="${statusIcon}" class="${statusColor}" size="16"></i>
                        <button onclick="deployServer('${server.name}')" 
                                class="text-blue-400 hover:text-blue-300">
                            <i data-lucide="rocket" size="14"></i>
                        </button>
                    </div>
                `;
                container.appendChild(serverDiv);
            });
            
            lucide.createIcons();
        }

        async function updateRegistryStatus() {
            try {
                // Simulate registry status
                document.getElementById('active-servers-count').textContent = servers.filter(s => s.status === 'running').length;
                document.getElementById('total-functions-count').textContent = Math.floor(Math.random() * 50) + 20;
            } catch (error) {
                console.error('Failed to update registry status:', error);
            }
        }

        function updateConsciousnessLevel() {
            const level = 80 + Math.random() * 15; // 80-95%
            document.querySelector('#consciousness-level .text-amber-400').textContent = level.toFixed(1) + '%';
        }

        async function simulateGeneration() {
            const steps = [
                { text: 'Initializing consciousness layer...', progress: 10 },
                { text: 'Generating server template...', progress: 25 },
                { text: 'Creating custom functions...', progress: 50 },
                { text: 'Integrating with Zero Point Module...', progress: 75 },
                { text: 'Finalizing server configuration...', progress: 90 },
                { text: 'Server generation complete!', progress: 100 }
            ];

            for (const step of steps) {
                document.getElementById('progress-text').textContent = step.text;
                document.getElementById('progress-bar').style.width = step.progress + '%';
                await new Promise(resolve => setTimeout(resolve, 800));
            }
        }

        function showProgress() {
            document.getElementById('generation-progress').classList.remove('hidden');
            document.getElementById('progress-bar').style.width = '0%';
            document.getElementById('progress-text').textContent = 'Initializing...';
        }

        function hideProgress() {
            document.getElementById('generation-progress').classList.add('hidden');
        }

        function showSuccess(message) {
            // In a real implementation, this would show a proper notification
            alert(message);
        }

        function showError(message) {
            // In a real implementation, this would show a proper error notification
            alert(message);
        }

        function resetForm() {
            document.getElementById('generator-form').reset();
            document.getElementById('functions-container').innerHTML = '';
            customFunctions = [];
        }

        async function deployServer(serverName) {
            try {
                showSuccess(`Deploying ${serverName}...`);
                // In a real implementation, this would call the deployment API
                setTimeout(() => {
                    loadServers();
                }, 2000);
            } catch (error) {
                showError('Failed to deploy server: ' + error.message);
            }
        }
    </script>
</body>
</html>
